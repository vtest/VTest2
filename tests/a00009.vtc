varnishtest "Code coverage of VCL compiler and RSTdump etc"

shell "varnishd -b 127.0.0.1:80 -C -n ${tmpdir} > /${tmpdir}/_.c"
shell "varnishd -x dumprstparam > /${tmpdir}/_.param"
shell "varnishd -x dumprstvsl > /${tmpdir}/_.vsl"
shell "varnishd -x dumprstcli > /${tmpdir}/_.cli"
err_shell {VCL version declaration missing} "echo 'bad vcl' >${tmpdir}/t.vcl ; varnishd -f ${tmpdir}/t.vcl -n ${tmpdir} 2>&1"
err_shell {VCL version declaration missing} "echo 'bad vcl' >${tmpdir}/t.vcl ; varnishd -C -f ${tmpdir}/t.vcl -n ${tmpdir} 2>&1"
err_shell {-spersistent has been deprecated} "varnishd -spersistent 2>&1"
err_shell {Unknown jail method "xyz"} "varnishd -jxyz 2>&1"
err_shell {-j must be the first argument} "varnishd -jnone -jxyz 2>&1"
err_shell {-j must be the first argument} "varnishd -d -jxyz 2>&1"
